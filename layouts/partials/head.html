<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{{ if .IsPage }}{{ .Title }} | {{ end }}{{ .Site.Title }}</title>
  {{ with .Site.Params.description }}<meta name="description" content="{{ . }}">{{ end }}
  
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  
  <style>
    * { box-sizing: border-box; }
    body { 
      font-family: 'Courier New', monospace; 
      margin: 0; 
      background-color: #16213e !important;
      background: #16213e;
      background: -webkit-linear-gradient(315deg, #0a0a0a 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #0a0a0a 100%);
      background: linear-gradient(135deg, #0a0a0a 0%, #1a1a2e 25%, #16213e 50%, #0f3460 75%, #0a0a0a 100%);
      background-size: 400% 400%;
      -webkit-animation: gradient 15s ease infinite;
      animation: gradient 15s ease infinite;
      color: #c9d1d9; 
      font-size: 16px;
      line-height: 1.6;
      position: relative;
      overflow-x: hidden;
    }
    
    /* Weather effects - will be dynamically set by season */
    body::before {
      content: '';
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100vh;
      background-repeat: repeat;
      opacity: 0.15;
      pointer-events: none;
      z-index: -1;
    }
    
    @-webkit-keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    .layout {
      display: flex;
      min-height: 100vh;
      max-width: 1000px;
      margin: 0 auto;
    }
    
    .sidebar {
      width: 280px;
      padding: 45px 20px 40px 20px;
      position: static;
      height: auto;
    }

    .content {
      width: 720px;
      padding: 40px;
      flex: 1;
    }
    
    .profile {
      display: flex;
      align-items: flex-start;
      gap: 15px;
      margin-bottom: 30px;
    }
    html.weather-rain body::before,
    html.weather-rain body::after {
      content: "";
      position: fixed;
      inset: -50dvh 0 0 0;
      height: 200dvh;
      width: 100%;
      pointer-events: none;
      z-index: 0;
      background-repeat: repeat;
      will-change: transform;
      contain: paint;
      backface-visibility: hidden;
      transform: translate3d(0,0,0);
    }
    
    /* fine rain - fast layer */
    html.weather-rain body::before {
      opacity: 0.25;
      background-image:
        radial-gradient(1px 8px at 23px 17px, #7dd3fc, transparent),
        radial-gradient(1px 6px at 142px 8px, #38bdf8, transparent),
        radial-gradient(1px 9px at 251px 19px, #0ea5e9, transparent),
        radial-gradient(1px 7px at 334px 12px, #7dd3fc, transparent),
        radial-gradient(1px 10px at 45px 23px, #38bdf8, transparent),
        radial-gradient(1px 8px at 167px 29px, #0ea5e9, transparent);
      background-size: 400px 60px, 400px 60px, 400px 60px, 400px 60px, 400px 80px, 400px 80px;
      animation: rainMoveA 6s linear infinite;
    }
    
    /* depth rain - slow layer */
    html.weather-rain body::after {
      opacity: 0.15;
      background-image:
        radial-gradient(1px 9px at 56px 27px, #7dd3fc, transparent),
        radial-gradient(1px 7px at 187px 39px, #38bdf8, transparent),
        radial-gradient(1px 8px at 323px 8px, #0ea5e9, transparent),
        radial-gradient(1px 10px at 112px 45px, #7dd3fc, transparent),
        radial-gradient(1px 11px at 78px 16px, #38bdf8, transparent);
      background-size: 400px 70px, 400px 70px, 400px 70px, 400px 70px, 400px 100px;
      animation: rainMoveB 9s linear infinite;
    }
    
    @keyframes rainMoveA {
      from { transform: translate3d(0,-50dvh,0); }
      to   { transform: translate3d(0,0,0); }
    }
    
    @keyframes rainMoveB {
      from { transform: translate3d(0,-50dvh,0); }
      to   { transform: translate3d(0,0,0); }
    }
    
    /* Summer effect (light particles) - GPU-optimized transform-based */
    html.weather-summer body::before,
    html.weather-summer body::after {
      content: "";
      position: fixed;
      inset: -50dvh 0 0 0;
      height: 200dvh;
      width: 100%;
      pointer-events: none;
      z-index: 0;
      background-repeat: repeat;
      will-change: transform;
      contain: paint;
      backface-visibility: hidden;
      transform: translate3d(0,0,0);
    }
    
    /* small/medium particles - gentle float */
    html.weather-summer body::before {
      opacity: 0.1;
      background-image:
        radial-gradient(1px 1px at 25px 30px, #fbbf24, transparent),
        radial-gradient(1.5px 1.5px at 125px 20px, #f59e0b, transparent),
        radial-gradient(1px 1px at 225px 40px, #fcd34d, transparent),
        radial-gradient(2px 2px at 65px 35px, #f59e0b, transparent),
        radial-gradient(1.5px 1.5px at 165px 25px, #fcd34d, transparent),
        radial-gradient(2px 2px at 275px 45px, #fbbf24, transparent);
      background-size: 340px 50px, 340px 50px, 340px 50px, 340px 70px, 340px 70px, 340px 70px;
      animation: summerFloatA 19s ease-in-out infinite;
    }
    
    /* larger particles - slow drift */
    html.weather-summer body::after {
      opacity: 0.08;
      background-image:
        radial-gradient(2.5px 2.5px at 45px 40px, #fcd34d, transparent),
        radial-gradient(2px 2px at 185px 30px, #f59e0b, transparent),
        radial-gradient(2.5px 2.5px at 305px 20px, #fbbf24, transparent),
        radial-gradient(1.5px 1.5px at 85px 25px, #fbbf24, transparent),
        radial-gradient(2px 2px at 195px 35px, #f59e0b, transparent);
      background-size: 340px 90px, 340px 90px, 340px 90px, 340px 60px, 340px 60px;
      animation: summerFloatB 31s ease-in-out infinite;
    }
    
    @keyframes summerFloatA {
      0%, 100% { transform: translate3d(0,-50dvh,0) rotate(0deg); }
      25% { transform: translate3d(0,-45dvh,0) rotate(45deg); }
      50% { transform: translate3d(0,-25dvh,0) rotate(90deg); }
      75% { transform: translate3d(0,-10dvh,0) rotate(135deg); }
    }
    
    @keyframes summerFloatB {
      0%, 100% { transform: translate3d(0,-50dvh,0) rotate(0deg); }
      25% { transform: translate3d(0,-40dvh,0) rotate(-30deg); }
      50% { transform: translate3d(0,-20dvh,0) rotate(60deg); }
      75% { transform: translate3d(0,-5dvh,0) rotate(-90deg); }
    }
    
    /* Spring effect (petals) - GPU-optimized transform-based */
    html.weather-spring body::before,
    html.weather-spring body::after {
      content: "";
      position: fixed;
      inset: -50dvh 0 0 0;
      height: 200dvh;
      width: 100%;
      pointer-events: none;
      z-index: 0;
      background-repeat: repeat;
      will-change: transform;
      contain: paint;
      backface-visibility: hidden;
      transform: translate3d(0,0,0);
    }
    
    /* small/medium petals - gentle drift */
    html.weather-spring body::before {
      opacity: 0.15;
      background-image:
        radial-gradient(2px 3px at 30px 20px, #fda4af, transparent),
        radial-gradient(3px 2px at 130px 40px, #fb7185, transparent),
        radial-gradient(2px 2px at 230px 15px, #fce7f3, transparent),
        radial-gradient(3px 4px at 70px 25px, #fb7185, transparent),
        radial-gradient(4px 3px at 170px 18px, #fce7f3, transparent),
        radial-gradient(3px 3px at 280px 42px, #fda4af, transparent);
      background-size: 360px 55px, 360px 55px, 360px 55px, 360px 75px, 360px 75px, 360px 75px;
      animation: petalsDriftA 13s ease-in-out infinite;
    }
    
    /* larger petals - slow fall */
    html.weather-spring body::after {
      opacity: 0.1;
      background-image:
        radial-gradient(4px 5px at 40px 32px, #fce7f3, transparent),
        radial-gradient(5px 4px at 190px 28px, #fb7185, transparent),
        radial-gradient(4px 4px at 310px 12px, #fda4af, transparent),
        radial-gradient(3px 3px at 90px 22px, #fda4af, transparent),
        radial-gradient(2px 4px at 200px 38px, #fb7185, transparent);
      background-size: 360px 95px, 360px 95px, 360px 95px, 360px 65px, 360px 65px;
      animation: petalsDriftB 23s ease-in-out infinite;
    }
    
    @keyframes petalsDriftA {
      0% { transform: translate3d(0,-50dvh,0) rotate(0deg); }
      25% { transform: translate3d(0,-35dvh,0) rotate(5deg); }
      50% { transform: translate3d(0,-20dvh,0) rotate(-3deg); }
      75% { transform: translate3d(0,-5dvh,0) rotate(4deg); }
      100% { transform: translate3d(0,0,0) rotate(0deg); }
    }
    
    @keyframes petalsDriftB {
      0% { transform: translate3d(0,-50dvh,0) rotate(0deg); }
      25% { transform: translate3d(0,-40dvh,0) rotate(-6deg); }
      50% { transform: translate3d(0,-25dvh,0) rotate(4deg); }
      75% { transform: translate3d(0,-10dvh,0) rotate(-3deg); }
      100% { transform: translate3d(0,0,0) rotate(0deg); }
    }
    
    @-webkit-keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    @keyframes gradient {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }
    
    /* Disable the big background gradient animation when weather is active */
    html[class*="weather-"] body {
      animation: none;
    }
    
    /* Respect reduced motion */
    @media (prefers-reduced-motion: reduce) {
      [class*="weather-"] body::before,
      [class*="weather-"] body::after { 
        animation: none !important; 
      }
    }
    
    /* Falling leaves for autumn */
    .leaves-layer {
      position: fixed;
      inset: 0;
      pointer-events: none;
      z-index: 1;
      contain: layout style paint;
    }

    .leaf {
      position: absolute;
      top: -10dvh;
      will-change: transform;
      transform: translate3d(0, -10dvh, 0);
      filter: drop-shadow(0 2px 1px rgba(0,0,0,.25));
      font-size: var(--size, 20px);
      animation: leaf-fall var(--fall, 12s) linear var(--delay, 0s) 1 both;
      opacity: var(--opacity, .9);
    }

    @keyframes leaf-fall {
      0%   { transform: translate3d(var(--xStart, 0vw), -10dvh, 0) rotate(0deg); }
      25%  { transform: translate3d(calc(var(--xStart, 0vw) + var(--amp, 20px)), 25dvh, 0) rotate(90deg); }
      50%  { transform: translate3d(calc(var(--xStart, 0vw) - var(--amp, 20px)), 50dvh, 0) rotate(180deg); }
      75%  { transform: translate3d(calc(var(--xStart, 0vw) + var(--amp, 20px)), 75dvh, 0) rotate(270deg); }
      100% { transform: translate3d(calc(var(--xStart, 0vw) + var(--drift, 0px)), 110dvh, 0) rotate(360deg); }
    }

    @media (prefers-reduced-motion: reduce) {
      .leaves-layer, .leaf { animation: none !important; display: none !important; }
    }
    
    .layout {
      display: flex;
      min-height: 100vh;
      max-width: 1000px;
      margin: 0 auto;
    }
    
    .sidebar {
      width: 280px;
      padding: 45px 20px 40px 20px;
      position: static;
      height: auto;
    }
    
    .content {
      width: 720px;
      padding: 40px;
      flex: 1;
    }
    
    .profile {
      display: flex;
      align-items: flex-start;
      gap: 15px;
      margin-bottom: 30px;
    }
    
    .profile-text h1 {
      margin: 0 0 10px 0;
      font-size: 18px;
    }
    
    .avatar {
      width: 48px;
      height: 48px;
      image-rendering: pixelated;
      image-rendering: -moz-crisp-edges;
      image-rendering: crisp-edges;
      flex-shrink: 0;
      margin-top: 5px;
    }
    
    .profile h1 a {
      color: #58a6ff;
      text-decoration: none;
    }
    
    .profile h1 a:hover {
      text-decoration: underline;
    }
    
    .status {
      color: #7c3aed;
      font-size: 12px;
      margin-bottom: 30px;
    }
    
    .status-indicator {
      color: #3fb950;
      animation: pulse 2s infinite;
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; }
      50% { opacity: 0.5; }
    }
    
    .nav {
      display: flex;
      flex-direction: column;
      gap: 5px;
      margin-bottom: 30px;
    }
    
    .nav a {
      color: #8b949e;
      text-decoration: none;
      padding: 5px 0;
      font-size: 13px;
    }
    
    .nav a:hover {
      color: #58a6ff;
    }
    
    .info {
      padding-top: 20px;
    }
    
    .info h3 {
      color: #f0f6fc;
      font-size: 12px;
      margin: 0 0 10px 0;
      text-transform: uppercase;
    }
    
    .info p {
      margin: 5px 0;
      font-size: 12px;
      color: #8b949e;
    }
    
    h1, h2, h3 {
      color: #f0f6fc;
    }
    
    .home h1 {
      margin-top: 0;
      margin-bottom: 5px;
    }
    
    .subtitle {
      color: #8b949e;
      display: block;
      margin-bottom: 30px;
    }
    
    .blog-list h1,
    .blog-post h1 {
      margin-top: 0;
    }
    
    .post-item {
      margin-bottom: 30px;
      padding-bottom: 20px;
    }
    
    .post-item h2 {
      margin: 0 0 5px 0;
      font-size: 18px;
    }
    
    .post-item time {
      color: #8b949e;
      font-size: 12px;
    }
    
    .post-header {
      margin-bottom: 30px;
    }
    
    .post-header time {
      color: #8b949e;
      font-size: 12px;
    }
    
    .post-footer {
      margin-top: 40px;
      padding-top: 20px;
    }
    
    .contact {
      margin-top: 30px;
    }
    
    .contact h2 {
      margin-bottom: 15px;
      font-size: 16px;
    }
    
    .socials {
      display: flex;
      gap: 15px;
    }
    
    .socials a {
      display: flex;
      align-items: center;
      gap: 6px;
      text-decoration: none;
    }
    
    .socials svg {
      flex-shrink: 0;
    }
    
    .recent-posts {
      margin-top: 40px;
    }
    
    .recent-posts h2 {
      margin-bottom: 20px;
      font-size: 16px;
    }
    
    .post-link {
      padding: 8px 0;
    }
    
    .post-link time {
      color: #8b949e;
      font-size: 12px;
      margin-left: 10px;
    }
    
    .section h1 {
      margin-top: 0;
    }
    
    .bookmark-grid {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 40px;
      margin-top: 30px;
    }
    
    .bookmark-col h2 {
      font-size: 14px;
      text-transform: uppercase;
      margin: 0 0 15px 0;
    }
    
    .bookmark-col h2:not(:first-child) {
      margin-top: 30px;
    }
    
    .bookmark-col ul {
      margin: 0 0 30px 0;
      padding: 0;
      list-style: none;
    }
    
    .bookmark-col li {
      margin-bottom: 8px;
    }
    
    @media (max-width: 768px) {
      .bookmark-grid {
        grid-template-columns: 1fr;
        gap: 20px;
      }
    }
    
    .section h2 {
      font-size: 14px;
      text-transform: uppercase;
      margin: 30px 0 20px 0;
    }
    
    .section h2:first-of-type {
      margin-top: 20px;
    }
    
    .section p strong {
      font-size: 16px;
    }
    
    .section p em {
      color: #8b949e;
      font-size: 12px;
      font-style: normal;
    }
    
    .section p {
      margin: 0 0 20px 0;
    }
    
    .error-page {
      text-align: center;
      padding: 60px 20px;
    }
    
    .error-page h1 {
      font-size: 72px;
      margin: 0 0 20px 0;
      color: #f85149;
    }
    
    .error-page p {
      font-size: 16px;
      margin: 0 0 15px 0;
    }
    
    .error-nav {
      margin-top: 40px;
      display: flex;
      gap: 20px;
      justify-content: center;
    }
    
    .error-nav a {
      padding: 8px 16px;
      text-decoration: none;
    }
    
    .breadcrumb {
      margin: 0 0 20px 0;
    }
    
    .read-more {
      font-size: 12px;
      display: inline-block;
      margin-top: 10px;
    }
    
    .posts-header {
      display: flex;
      align-items: center;
      gap: 20px;
      margin-bottom: 20px;
    }
    
    .posts-header h1,
    .posts-header h2 {
      margin: 0;
    }
    
    .rss-button {
      background: linear-gradient(135deg, #ff8800 0%, #ff6600 100%);
      color: #fff;
      padding: 2px 12px;
      border-radius: 12px;
      text-decoration: none;
      font-size: 12px;
      font-weight: bold;
      text-transform: uppercase;
      transition: all 0.2s ease;
      letter-spacing: 0.5px;
    }
    
    .rss-button:hover {
      background: linear-gradient(135deg, #ffaa22 0%, #e55a00 100%);
      color: #fff;
    }
    
    a {
      color: #58a6ff;
    }
    
    a:hover {
      text-decoration: underline;
    }
    
    /* Code blocks */
    pre {
      background: #21262d;
      border: 1px solid #30363d;
      border-radius: 6px;
      padding: 16px;
      overflow-x: auto;
      font-family: 'Courier New', monospace;
      font-size: 13px;
      line-height: 1.45;
      margin: 16px 0;
    }
    
    code {
      font-family: 'Courier New', monospace;
      font-size: 13px;
      background: #21262d;
      padding: 2px 4px;
      border-radius: 3px;
      color: #f0f6fc;
    }
    
    pre code {
      background: none;
      padding: 0;
      border-radius: 0;
      font-size: 13px;
    }
    
    .mobile-nav,
    .mobile-info {
      display: none;
    }
    
    @media (max-width: 768px) {
      .layout {
        flex-direction: column;
      }
      .sidebar {
        display: none;
      }
      .content {
        width: 100%;
        padding: 20px;
      }
      
      .home h1 {
        display: flex;
        align-items: center;
        gap: 15px;
        margin-top: 0;
      }
      
      .home h1::after {
        content: "";
        background: url("/avatar.png") no-repeat center;
        background-size: contain;
        width: 48px;
        height: 48px;
        image-rendering: pixelated;
        image-rendering: -moz-crisp-edges;
        image-rendering: crisp-edges;
        margin-top: 5px;
      }
      
      .mobile-nav {
        display: flex;
        flex-direction: row;
        align-items: center;
        gap: 20px;
        padding: 30px 20px 10px 20px;
        flex-wrap: wrap;
      }
      
      .mobile-nav a {
        color: #8b949e;
        text-decoration: none;
        font-size: 13px;
      }
      
      .mobile-nav a:hover {
        color: #58a6ff;
      }
      
      .mobile-home {
        color: #58a6ff !important;
        font-size: 18px !important;
        font-weight: normal !important;
      }
      
      .mobile-home:hover {
        text-decoration: underline !important;
      }
      
      .mobile-info {
        display: block;
        margin-top: 40px;
        padding-top: 20px;
        border-top: 1px solid #30363d;
      }
      
      .mobile-info h3 {
        color: #f0f6fc;
        font-size: 12px;
        margin: 0 0 10px 0;
        text-transform: uppercase;
      }
      
      .mobile-info p {
        margin: 5px 0;
        font-size: 12px;
        color: #8b949e;
      }
    }
  </style>
  
  <!-- Seasonal Weather Effects -->
  {{ partial "weather/winter.html" . }}
  {{ partial "weather/autumn.html" . }}
  {{ partial "weather/summer.html" . }}
  {{ partial "weather/spring.html" . }}
  
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      // Determine current season based on date
      function getCurrentSeason() {
        const now = new Date();
        const month = now.getMonth() + 1; // getMonth() returns 0-11
        
        // Northern hemisphere seasons (adjust if needed)
        if (month >= 12 || month <= 2) {
          return 'winter'; // Dec, Jan, Feb
        } else if (month >= 3 && month <= 5) {
          return 'spring'; // Mar, Apr, May
        } else if (month >= 6 && month <= 8) {
          return 'summer'; // Jun, Jul, Aug
        } else {
          return 'autumn'; // Sep, Oct, Nov
        }
      }
      
      // Apply weather class based on season
      function applySeasonalWeather() {
        const season = getCurrentSeason();
        const html = document.documentElement;
        
        // Remove any existing weather classes
        html.classList.remove('weather-snow', 'weather-rain', 'weather-summer', 'weather-spring');
        
        // Apply the appropriate weather class
        switch(season) {
          case 'winter':
            html.classList.add('weather-snow');
            break;
          case 'spring':
            html.classList.add('weather-spring');
            break;
          case 'summer':
            html.classList.add('weather-summer');
            break;
          case 'autumn':
            html.classList.add('weather-rain');
            break;
          default:
            html.classList.add('weather-rain'); // fallback to rain
        }
        
      }
      
      // Apply seasonal weather on page load
      applySeasonalWeather();
      
      // All weather effects are now CSS-only
      
      // Optional: Allow manual override via localStorage
      const manualSeason = localStorage.getItem('manualSeason');
      if (manualSeason && ['winter', 'spring', 'summer', 'autumn'].includes(manualSeason)) {
        const html = document.documentElement;
        html.classList.remove('weather-snow', 'weather-rain', 'weather-summer', 'weather-spring');
        html.classList.add(`weather-${manualSeason === 'autumn' ? 'rain' : manualSeason === 'winter' ? 'snow' : manualSeason}`);
        
      }
    });
    

    // Debug function to manually set season (can be called from browser console)
    window.setSeason = function(season) {
      if (['winter', 'spring', 'summer', 'autumn'].includes(season)) {
        localStorage.setItem('manualSeason', season);
        
        // Apply new season
        const html = document.documentElement;
        html.classList.remove('weather-snow', 'weather-rain', 'weather-summer', 'weather-spring');
        html.classList.add(`weather-${season === 'autumn' ? 'rain' : season === 'winter' ? 'snow' : season}`);
        
      } else {
        console.log('Valid seasons: winter, spring, summer, autumn');
      }
    };
    
    // Debug function to clear manual override
    window.clearSeasonOverride = function() {
      localStorage.removeItem('manualSeason');
      location.reload();
    };
  </script>
</head>
